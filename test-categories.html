<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Test Categories Loading</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getFirestore, collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAeMt3Ahtg6FNRGY1cUuySoxUsJdzr7Z7A",
      authDomain: "k-highway-shop.firebaseapp.com",
      projectId: "k-highway-shop",
      storageBucket: "k-highway-shop.firebasestorage.app",
      messagingSenderId: "568359321582",
      appId: "1:568359321582:web:faf2b48cb3556664b898ff"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function testCategories() {
      console.log('Testing category loading...');

      try {
        // Try to get categories
        const snapshot = await getDocs(collection(db, 'categories'));
        console.log('Categories found:', snapshot.size);

        if (snapshot.empty) {
          console.log('No categories in database. Adding test category...');

          // Add a test category
          const testCategory = {
            name: 'Test Category',
            slug: 'test-category',
            description: 'This is a test category',
            icon: 'ðŸ”§',
            order: 1,
            createdAt: new Date()
          };

          await addDoc(collection(db, 'categories'), testCategory);
          console.log('Test category added!');

          // Try loading again
          const newSnapshot = await getDocs(collection(db, 'categories'));
          console.log('Categories after adding:', newSnapshot.size);
        }

        // Display categories
        const output = document.getElementById('output');
        snapshot.forEach(doc => {
          const category = doc.data();
          console.log('Category:', category);
          output.innerHTML += `<p>Category: ${category.name} (${category.slug})</p>`;
        });

      } catch (error) {
        console.error('Error:', error);
        document.getElementById('output').innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
      }
    }

    // Run test when page loads
    window.addEventListener('DOMContentLoaded', testCategories);
  </script>
</head>
<body>
  <h1>Testing Categories Loading</h1>
  <div id="output">Loading...</div>
  <p>Check the browser console for detailed information.</p>
</body>
</html>